{"version":3,"file":"zwc-chart-base.js","sources":["../../../../../../src/components/zwc-chart-base/zwc-chart-base.ts"],"sourcesContent":["import { customElement, state } from 'lit/decorators.js';\r\nimport { ref, createRef } from 'lit/directives/ref.js';\r\nimport { html, TemplateResult } from 'lit';\r\n\r\nimport { Base } from '../base';\r\nimport type {\r\n  ChartComponentLike,\r\n  ChartData,\r\n  ChartOptions,\r\n  ChartType,\r\n  Plugin,\r\n} from 'chart.js';\r\nimport { Chart } from 'chart.js';\r\nimport { legendMargin } from '../../plugins';\r\nimport { deepMerge } from '../../utils';\r\n\r\n/**\r\n * Base Chart of chartjs-web-components\r\n */\r\n@customElement('zwc-base-chart')\r\nexport abstract class ZwcBaseChart extends Base {\r\n  public abstract componentsToRegister: ChartComponentLike[];\r\n  public abstract type: ChartType;\r\n  public abstract options: ChartOptions;\r\n  public abstract defaultOptions: ChartOptions;\r\n  public abstract data: ChartData;\r\n\r\n  public chartConstructor = Chart;\r\n  public chart: Chart | undefined;\r\n  public plugins: Plugin<ChartType>[] = [];\r\n\r\n  canvasRef = createRef<HTMLCanvasElement>();\r\n  defaultPlugins: Plugin<ChartType>[] = [legendMargin];\r\n\r\n  @state()\r\n  get mergedOptions(): ChartOptions {\r\n    return deepMerge(this.defaultOptions, this.options);\r\n  }\r\n\r\n  public firstUpdated(): void {\r\n    if (!this.chart) {\r\n      const ctx: CanvasRenderingContext2D | null | undefined =\r\n        this.canvasRef.value?.getContext('2d');\r\n\r\n      if (ctx) {\r\n        this.chartConstructor.register(...this.componentsToRegister);\r\n        this.chart = new this.chartConstructor(ctx, {\r\n          type: this.type,\r\n          options: this.mergedOptions,\r\n          data: this.data,\r\n          plugins: [...this.defaultPlugins, ...this.plugins],\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  // On init\r\n  public connectedCallback(): void {\r\n    super.connectedCallback();\r\n    window.addEventListener('resize', this.handleResize.bind(this));\r\n  }\r\n\r\n  // On destroy\r\n  public disconnectedCallback(): void {\r\n    super.disconnectedCallback();\r\n    window.removeEventListener('resize', this.handleResize);\r\n  }\r\n\r\n  protected handleResize(): void {\r\n    this.chart?.resize();\r\n  }\r\n\r\n  public override render(): TemplateResult {\r\n    return html`\r\n      <style>\r\n        .chart-size {\r\n          position: relative;\r\n        }\r\n        canvas {\r\n          width: 400px;\r\n          height: 400px;\r\n        }\r\n      </style>\r\n      <div class=\"chart-size\">\r\n        <canvas ${ref(this.canvasRef)}></canvas>\r\n      </div>\r\n    `;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'zwc-base-chart': ZwcBaseChart;\r\n  }\r\n}\r\n"],"names":["ZwcBaseChart","Base","Chart","createRef","legendMargin","deepMerge","ctx","_a","html","ref","__decorateClass","state","customElement"],"mappings":";;;;;;;;;;;;;;;;;;AAoBsB,IAAAA,IAAf,cAAoCC,EAAK;AAAA,EAAzC,cAAA;AAAA,UAAA,GAAA,SAAA,GAOL,KAAO,mBAAmBC,GAE1B,KAAO,UAA+B,IAEtC,KAAA,YAAYC,KACZ,KAAA,iBAAsC,CAACC,CAAY;AAAA,EAAA;AAAA,EAGnD,IAAI,gBAA8B;AAChC,WAAOC,EAAU,KAAK,gBAAgB,KAAK,OAAO;AAAA,EACpD;AAAA,EAEO,eAAqB;;AACtB,QAAA,CAAC,KAAK,OAAO;AACf,YAAMC,KACJC,IAAA,KAAK,UAAU,UAAf,gBAAAA,EAAsB,WAAW;AAEnC,MAAID,MACF,KAAK,iBAAiB,SAAS,GAAG,KAAK,oBAAoB,GAC3D,KAAK,QAAQ,IAAI,KAAK,iBAAiBA,GAAK;AAAA,QAC1C,MAAM,KAAK;AAAA,QACX,SAAS,KAAK;AAAA,QACd,MAAM,KAAK;AAAA,QACX,SAAS,CAAC,GAAG,KAAK,gBAAgB,GAAG,KAAK,OAAO;AAAA,MAAA,CAClD;AAAA,IAEL;AAAA,EACF;AAAA,EAGO,oBAA0B;AAC/B,UAAM,kBAAkB,GACxB,OAAO,iBAAiB,UAAU,KAAK,aAAa,KAAK,IAAI,CAAC;AAAA,EAChE;AAAA,EAGO,uBAA6B;AAClC,UAAM,qBAAqB,GACpB,OAAA,oBAAoB,UAAU,KAAK,YAAY;AAAA,EACxD;AAAA,EAEU,eAAqB;;AAC7B,KAAAC,IAAA,KAAK,UAAL,QAAAA,EAAY;AAAA,EACd;AAAA,EAEgB,SAAyB;AAChC,WAAAC;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,kBAWOC,EAAI,KAAK,SAAS;AAAA;AAAA;AAAA,EAGlC;AACF;AArDMC,EAAA;AAAA,EADHC,EAAM;AAAA,GAdaX,EAehB,WAAA,iBAAA,CAAA;AAfgBA,IAAfU,EAAA;AAAA,EADNE,EAAc,gBAAgB;AAAA,GACTZ,CAAA;"}