"use strict";const h=require("../../lib/utils.cjs"),d=require("../../lib/date.cjs"),o=require("../../lib/date-format.cjs"),r=require("../../lib/dom.cjs"),u=require("../templates/daysTemplate.cjs"),k=require("../templates/calendarWeeksTemplate.cjs"),g=require("./View.cjs");class m extends g{constructor(e){super(e,{id:0,name:"days",cellClass:"day"})}init(e,a=!0){if(a){const s=r.parseHTML(u).firstChild;this.dow=s.firstChild,this.grid=s.lastChild,this.element.appendChild(s)}super.init(e)}setOptions(e){let a;if(h.hasProperty(e,"minDate")&&(this.minDate=e.minDate),h.hasProperty(e,"maxDate")&&(this.maxDate=e.maxDate),e.datesDisabled&&(this.datesDisabled=e.datesDisabled),e.daysOfWeekDisabled&&(this.daysOfWeekDisabled=e.daysOfWeekDisabled,a=!0),e.daysOfWeekHighlighted&&(this.daysOfWeekHighlighted=e.daysOfWeekHighlighted),e.todayHighlight!==void 0&&(this.todayHighlight=e.todayHighlight),e.weekStart!==void 0&&(this.weekStart=e.weekStart,this.weekEnd=e.weekEnd,a=!0),e.locale){const s=this.locale=e.locale;this.dayNames=s.daysMin,this.switchLabelFormat=s.titleFormat,a=!0}if(e.beforeShowDay!==void 0&&(this.beforeShow=typeof e.beforeShowDay=="function"?e.beforeShowDay:void 0),e.calendarWeeks!==void 0)if(e.calendarWeeks&&!this.calendarWeeks){const s=r.parseHTML(k).firstChild;this.calendarWeeks={element:s,dow:s.firstChild,weeks:s.lastChild},this.element.insertBefore(s,this.element.firstChild)}else this.calendarWeeks&&!e.calendarWeeks&&(this.element.removeChild(this.calendarWeeks.element),this.calendarWeeks=null);e.showDaysOfWeek!==void 0&&(e.showDaysOfWeek?(r.showElement(this.dow),this.calendarWeeks&&r.showElement(this.calendarWeeks.dow)):(r.hideElement(this.dow),this.calendarWeeks&&r.hideElement(this.calendarWeeks.dow))),a&&Array.from(this.dow.children).forEach((s,i)=>{const t=(this.weekStart+i)%7;s.textContent=this.dayNames[t],s.className=this.daysOfWeekDisabled.includes(t)?"dow disabled":"dow"})}updateFocus(){const e=new Date(this.picker.viewDate),a=e.getFullYear(),s=e.getMonth(),i=d.dateValue(a,s,1),t=d.dayOfTheWeekOf(i,this.weekStart,this.weekStart);this.first=i,this.last=d.dateValue(a,s+1,0),this.start=t,this.focused=this.picker.viewDate}updateSelection(){const{dates:e,rangepicker:a}=this.picker.datepicker;this.selected=e,a&&(this.range=a.dates)}render(){this.today=this.todayHighlight?d.today():void 0,this.disabled=[...this.datesDisabled];const e=o.formatDate(this.focused,this.switchLabelFormat,this.locale);if(this.picker.setViewSwitchLabel(e),this.picker.setPrevBtnDisabled(this.first<=this.minDate),this.picker.setNextBtnDisabled(this.last>=this.maxDate),this.calendarWeeks){const a=d.dayOfTheWeekOf(this.first,1,1);Array.from(this.calendarWeeks.weeks.children).forEach((s,i)=>{s.textContent=d.getWeek(d.addWeeks(a,i))})}Array.from(this.grid.children).forEach((a,s)=>{const i=a.classList,t=d.addDays(this.start,s),l=new Date(t),c=l.getDay();if(a.className=`datepicker-cell ${this.cellClass}`,a.dataset.date=t,a.textContent=l.getDate(),t<this.first?i.add("prev"):t>this.last&&i.add("next"),this.today===t&&i.add("today"),(t<this.minDate||t>this.maxDate||this.disabled.includes(t))&&i.add("disabled"),this.daysOfWeekDisabled.includes(c)&&(i.add("disabled"),h.pushUnique(this.disabled,t)),this.daysOfWeekHighlighted.includes(c)&&i.add("highlighted"),this.range){const[n,f]=this.range;t>n&&t<f&&i.add("range"),t===n&&i.add("range-start"),t===f&&i.add("range-end")}this.selected.includes(t)&&i.add("selected"),t===this.focused&&i.add("focused"),this.beforeShow&&this.performBeforeHook(a,t,t)})}refresh(){const[e,a]=this.range||[];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach(s=>{s.classList.remove("range","range-start","range-end","selected","focused")}),Array.from(this.grid.children).forEach(s=>{const i=Number(s.dataset.date),t=s.classList;i>e&&i<a&&t.add("range"),i===e&&t.add("range-start"),i===a&&t.add("range-end"),this.selected.includes(i)&&t.add("selected"),i===this.focused&&t.add("focused")})}refreshFocus(){const e=Math.round((this.focused-this.start)/864e5);this.grid.querySelectorAll(".focused").forEach(a=>{a.classList.remove("focused")}),this.grid.children[e].classList.add("focused")}}module.exports=m;
//# sourceMappingURL=DaysView.cjs.map
