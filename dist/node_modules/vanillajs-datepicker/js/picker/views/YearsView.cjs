"use strict";const d=require("../../lib/utils.cjs"),a=require("../../lib/date.cjs"),f=require("../../lib/dom.cjs"),o=require("./View.cjs");function l(n){return[...n].reduce((e,t,s)=>e+=s?t:t.toUpperCase(),"")}class u extends o{constructor(e,t){super(e,t)}init(e,t=!0){t&&(this.navStep=this.step*10,this.beforeShowOption=`beforeShow${l(this.cellClass)}`,this.grid=this.element,this.element.classList.add(this.name,"datepicker-grid"),this.grid.appendChild(f.parseHTML(d.createTagRepeat("span",12)))),super.init(e)}setOptions(e){if(d.hasProperty(e,"minDate")&&(e.minDate===void 0?this.minYear=this.minDate=void 0:(this.minYear=a.startOfYearPeriod(e.minDate,this.step),this.minDate=a.dateValue(this.minYear,0,1))),d.hasProperty(e,"maxDate")&&(e.maxDate===void 0?this.maxYear=this.maxDate=void 0:(this.maxYear=a.startOfYearPeriod(e.maxDate,this.step),this.maxDate=a.dateValue(this.maxYear,11,31))),this.isMinView?e.datesDisabled&&(this.datesDisabled=e.datesDisabled):this.datesDisabled=[],e[this.beforeShowOption]!==void 0){const t=e[this.beforeShowOption];this.beforeShow=typeof t=="function"?t:void 0}}updateFocus(){const e=new Date(this.picker.viewDate),t=a.startOfYearPeriod(e,this.navStep),s=t+9*this.step;this.first=t,this.last=s,this.start=t-this.step,this.focused=a.startOfYearPeriod(e,this.step)}updateSelection(){const{dates:e,rangepicker:t}=this.picker.datepicker;this.selected=e.reduce((s,i)=>d.pushUnique(s,a.startOfYearPeriod(i,this.step)),[]),t&&t.dates&&(this.range=t.dates.map(s=>{if(s!==void 0)return a.startOfYearPeriod(s,this.step)}))}render(){this.disabled=this.datesDisabled.map(e=>new Date(e).getFullYear()),this.picker.setViewSwitchLabel(`${this.first}-${this.last}`),this.picker.setPrevBtnDisabled(this.first<=this.minYear),this.picker.setNextBtnDisabled(this.last>=this.maxYear),Array.from(this.grid.children).forEach((e,t)=>{const s=e.classList,i=this.start+t*this.step,r=a.dateValue(i,0,1);if(e.className=`datepicker-cell ${this.cellClass}`,this.isMinView&&(e.dataset.date=r),e.textContent=e.dataset.year=i,t===0?s.add("prev"):t===11&&s.add("next"),(i<this.minYear||i>this.maxYear||this.disabled.includes(i))&&s.add("disabled"),this.range){const[h,c]=this.range;i>h&&i<c&&s.add("range"),i===h&&s.add("range-start"),i===c&&s.add("range-end")}this.selected.includes(i)&&s.add("selected"),i===this.focused&&s.add("focused"),this.beforeShow&&this.performBeforeHook(e,i,r)})}refresh(){const[e,t]=this.range||[];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach(s=>{s.classList.remove("range","range-start","range-end","selected","focused")}),Array.from(this.grid.children).forEach(s=>{const i=Number(s.textContent),r=s.classList;i>e&&i<t&&r.add("range"),i===e&&r.add("range-start"),i===t&&r.add("range-end"),this.selected.includes(i)&&r.add("selected"),i===this.focused&&r.add("focused")})}refreshFocus(){const e=Math.round((this.focused-this.start)/this.step);this.grid.querySelectorAll(".focused").forEach(t=>{t.classList.remove("focused")}),this.grid.children[e].classList.add("focused")}}module.exports=u;
//# sourceMappingURL=YearsView.cjs.map
