{"version":3,"file":"YearsView.cjs","sources":["../../../../../../../../node_modules/vanillajs-datepicker/js/picker/views/YearsView.js"],"sourcesContent":["import {hasProperty, pushUnique, createTagRepeat} from '../../lib/utils.js';\nimport {dateValue, startOfYearPeriod} from '../../lib/date.js';\nimport {parseHTML} from '../../lib/dom.js';\nimport View from './View.js';\n\nfunction toTitleCase(word) {\n  return [...word].reduce((str, ch, ix) => str += ix ? ch : ch.toUpperCase(), '');\n}\n\n// Class representing the years and decades view elements\nexport default class YearsView extends View {\n  constructor(picker, config) {\n    super(picker, config);\n  }\n\n  init(options, onConstruction = true) {\n    if (onConstruction) {\n      this.navStep = this.step * 10;\n      this.beforeShowOption = `beforeShow${toTitleCase(this.cellClass)}`;\n      this.grid = this.element;\n      this.element.classList.add(this.name, 'datepicker-grid');\n      this.grid.appendChild(parseHTML(createTagRepeat('span', 12)));\n    }\n    super.init(options);\n  }\n\n  setOptions(options) {\n    if (hasProperty(options, 'minDate')) {\n      if (options.minDate === undefined) {\n        this.minYear = this.minDate = undefined;\n      } else {\n        this.minYear = startOfYearPeriod(options.minDate, this.step);\n        this.minDate = dateValue(this.minYear, 0, 1);\n      }\n    }\n    if (hasProperty(options, 'maxDate')) {\n      if (options.maxDate === undefined) {\n        this.maxYear = this.maxDate = undefined;\n      } else {\n        this.maxYear = startOfYearPeriod(options.maxDate, this.step);\n        this.maxDate = dateValue(this.maxYear, 11, 31);\n      }\n    }\n    if (this.isMinView) {\n      if (options.datesDisabled) {\n        this.datesDisabled = options.datesDisabled;\n      }\n    } else {\n      this.datesDisabled = [];\n    }\n    if (options[this.beforeShowOption] !== undefined) {\n      const beforeShow = options[this.beforeShowOption];\n      this.beforeShow = typeof beforeShow === 'function' ? beforeShow : undefined;\n    }\n  }\n\n  // Update view's settings to reflect the viewDate set on the picker\n  updateFocus() {\n    const viewDate = new Date(this.picker.viewDate);\n    const first = startOfYearPeriod(viewDate, this.navStep);\n    const last = first + 9 * this.step;\n\n    this.first = first;\n    this.last = last;\n    this.start = first - this.step;\n    this.focused = startOfYearPeriod(viewDate, this.step);\n  }\n\n  // Update view's settings to reflect the selected dates\n  updateSelection() {\n    const {dates, rangepicker} = this.picker.datepicker;\n    this.selected = dates.reduce((years, timeValue) => {\n      return pushUnique(years, startOfYearPeriod(timeValue, this.step));\n    }, []);\n    if (rangepicker && rangepicker.dates) {\n      this.range = rangepicker.dates.map(timeValue => {\n        if (timeValue !== undefined) {\n          return startOfYearPeriod(timeValue, this.step);\n        }\n      });\n    }\n  }\n\n  // Update the entire view UI\n  render() {\n    // refresh disabled years on every render in order to clear the ones added\n    // by beforeShow hook at previous render\n    // this.disabled = [...this.datesDisabled];\n    this.disabled = this.datesDisabled.map(disabled => new Date(disabled).getFullYear());\n\n    this.picker.setViewSwitchLabel(`${this.first}-${this.last}`);\n    this.picker.setPrevBtnDisabled(this.first <= this.minYear);\n    this.picker.setNextBtnDisabled(this.last >= this.maxYear);\n\n    Array.from(this.grid.children).forEach((el, index) => {\n      const classList = el.classList;\n      const current = this.start + (index * this.step);\n      const date = dateValue(current, 0, 1);\n\n      el.className = `datepicker-cell ${this.cellClass}`;\n      if (this.isMinView) {\n        el.dataset.date = date;\n      }\n      el.textContent = el.dataset.year = current;\n\n      if (index === 0) {\n        classList.add('prev');\n      } else if (index === 11) {\n        classList.add('next');\n      }\n      if (current < this.minYear || current > this.maxYear || this.disabled.includes(current)) {\n        classList.add('disabled');\n      }\n      if (this.range) {\n        const [rangeStart, rangeEnd] = this.range;\n        if (current > rangeStart && current < rangeEnd) {\n          classList.add('range');\n        }\n        if (current === rangeStart) {\n          classList.add('range-start');\n        }\n        if (current === rangeEnd) {\n          classList.add('range-end');\n        }\n      }\n      if (this.selected.includes(current)) {\n        classList.add('selected');\n      }\n      if (current === this.focused) {\n        classList.add('focused');\n      }\n\n      if (this.beforeShow) {\n        this.performBeforeHook(el, current, date);\n      }\n    });\n  }\n\n  // Update the view UI by applying the changes of selected and focused items\n  refresh() {\n    const [rangeStart, rangeEnd] = this.range || [];\n    this.grid\n      .querySelectorAll('.range, .range-start, .range-end, .selected, .focused')\n      .forEach((el) => {\n        el.classList.remove('range', 'range-start', 'range-end', 'selected', 'focused');\n      });\n    Array.from(this.grid.children).forEach((el) => {\n      const current = Number(el.textContent);\n      const classList = el.classList;\n      if (current > rangeStart && current < rangeEnd) {\n        classList.add('range');\n      }\n      if (current === rangeStart) {\n        classList.add('range-start');\n      }\n      if (current === rangeEnd) {\n        classList.add('range-end');\n      }\n      if (this.selected.includes(current)) {\n        classList.add('selected');\n      }\n      if (current === this.focused) {\n        classList.add('focused');\n      }\n    });\n  }\n\n  // Update the view UI by applying the change of focused item\n  refreshFocus() {\n    const index = Math.round((this.focused - this.start) / this.step);\n    this.grid.querySelectorAll('.focused').forEach((el) => {\n      el.classList.remove('focused');\n    });\n    this.grid.children[index].classList.add('focused');\n  }\n}\n"],"names":["toTitleCase","word","str","ch","ix","YearsView","View","picker","config","options","onConstruction","parseHTML","createTagRepeat","hasProperty","startOfYearPeriod","dateValue","beforeShow","viewDate","first","last","dates","rangepicker","years","timeValue","pushUnique","disabled","el","index","classList","current","date","rangeStart","rangeEnd"],"mappings":"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"}