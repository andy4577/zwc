"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const j=require("../lit-html.cjs"),C=require("../directive.cjs"),l=require("../directive-helpers.cjs");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const g=(i,d,h)=>{const f=new Map;for(let o=d;o<=h;o++)f.set(i[o],o);return f},x=C.directive(class extends C.Directive{constructor(i){if(super(i),i.type!==C.PartType.CHILD)throw Error("repeat() can only be used in text expressions")}ht(i,d,h){let f;h===void 0?h=d:d!==void 0&&(f=d);const o=[],e=[];let s=0;for(const u of i)o[s]=f?f(u,s):s,e[s]=h(u,s),s++;return{values:e,keys:o}}render(i,d,h){return this.ht(i,d,h).values}update(i,[d,h,f]){var o;const e=l.getCommittedValue(i),{values:s,keys:u}=this.ht(d,h,f);if(!Array.isArray(e))return this.ut=u,s;const P=(o=this.ut)!==null&&o!==void 0?o:this.ut=[],c=[];let p,y,t=0,a=e.length-1,r=0,n=s.length-1;for(;t<=a&&r<=n;)if(e[t]===null)t++;else if(e[a]===null)a--;else if(P[t]===u[r])c[r]=l.setChildPartValue(e[t],s[r]),t++,r++;else if(P[a]===u[n])c[n]=l.setChildPartValue(e[a],s[n]),a--,n--;else if(P[t]===u[n])c[n]=l.setChildPartValue(e[t],s[n]),l.insertPart(i,c[n+1],e[t]),t++,n--;else if(P[a]===u[r])c[r]=l.setChildPartValue(e[a],s[r]),l.insertPart(i,e[t],e[a]),a--,r++;else if(p===void 0&&(p=g(u,r,n),y=g(P,t,a)),p.has(P[t]))if(p.has(P[a])){const v=y.get(u[r]),m=v!==void 0?e[v]:null;if(m===null){const V=l.insertPart(i,e[t]);l.setChildPartValue(V,s[r]),c[r]=V}else c[r]=l.setChildPartValue(m,s[r]),l.insertPart(i,e[t],m),e[v]=null;r++}else l.removePart(e[a]),a--;else l.removePart(e[t]),t++;for(;r<=n;){const v=l.insertPart(i,c[n+1]);l.setChildPartValue(v,s[r]),c[r++]=v}for(;t<=a;){const v=e[t++];v!==null&&l.removePart(v)}return this.ut=u,l.setCommittedValue(i,c),j.noChange}});exports.repeat=x;
//# sourceMappingURL=repeat.cjs.map
